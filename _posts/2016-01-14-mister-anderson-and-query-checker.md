---
layout: post
title: Проверка наличия сайта в выдаче Яндекса с помощью Query Checker
excerpt: Как побороть первый редут поддержки Яндекса для случаев, когда поиск Яндекса отказывается индексировать ваш сайт.
big_image: /assets/images/mister_anderson_and_query_checker_big.png
small_image: /assets/images/notes_game_design_workshop_part1_small.png
location: Деревня Фамиана, остров Фукок
tags:
- gamedev
- книги
categories:
- community
---

Уверен, многим приходилось сталкиваться с поддержкой Яндекса из-за ужасной работы их поиска. Для Stack Overflow «ужасными» стали индексация и ранжирование в выдаче. [Яндекс просто отказывается работать с любым сайтом сети Stack Exhcange](http://chabanovsky.com/2015/11/yandex-does-not-index-so/)!

## Как происходит обращение в службу поддержки Яндекса

- Вы понимаете, что c сайтом что-то явно не так. Готовитесь, собираете обоснования и статистику. Находите форму обратной связи и пишите письмо в Яндекс.
- В течение пары недель с вами связывается некий Платон Щукин с просьбой показать, по какому именно запросу ваш сайт не найти. Здорово, не правда ли?

  - Если вы обычный разработчик, а не кулл-SEO-оптимизатор, вы вряд ли будете знать, по какому запросу вас нельзя найти. Переходов просто нет, и все. Как я понимаю, вопрос призван отсеять 99% всех написавших (то есть это вежливый посыл в известном направлении). К примеру, в среднем на Stack Overflow на английском на один вопрос в месяц приходят 0.8 пользователя, что при теоретическом равномерном распределении даст 8 000 000 (восемь миллионов) запросов. Физически невозможно проверить, «по какому запросу вашего сайта нет в выдаче». Яндекс как бы намекает: «давай, до свидания, у нас и без тебя все хорошо».
  - По своей горе-наивности, я считал, что Платон Щукин – это реальный человек. Представьте, каково было мое разочарование, когда после нескольких месяцев я узнал, что это не так. С тех пор, я называю «их» Мистер Андерсон.

- Если же вы все-таки сделаете детальный анализ (как раз о нем пойдет речь дальше), вам ответят, что проблема не в поиске, а в том, что «ваш сайт просто неинтересен пользователям». Любые доводы со статистикой, что из поиска Google на сайт переходит в 10–15 раз больше посетителей, что среднее время пребывания на странице высоко и т. д. безразлично Мистеру Андерсону. Ваш сайт неинтересен пользователям поиска Яндекса.

- Все. Конец истории. Яндексу и без вас хорошо. Доля рынка большая, деньги есть. __Работает – не трогай! __

## Как дойти до конца и понять, что мир несправедлив

Мне кажется, для большинства обычных информационных ресурсов крайне сложно, а то и вовсе невозможно понять, по каким запросам сайт находят пользователи в поиске. Все же давайте попробуем это сделать.

__1. Статистика переходов из поиска Google__

Для Stack Overflow поиск Google работает в 10–15 раз лучше Яндекса (для контраста, напрямую на сайт попадает в полтора раза больше человек, чем из поиска Яндекса). Вы можете использовать топ-100 поисковых запросов, по которым вас находят в Google, и сделать аналитику на их основе.

__2. Прямое совпадение заголовка страницы__

Возьмите от 100 до 200 последних страницы, созданных на сайте, и проверьте, можно ли найти каждую из них на первых трех или пяти страницах поисковой выдачи, если в качестве запроса использовать заголовок страницы (title). Эти данные могут быть еще одним камнем в сторону Яндекса.

__3. Наличие страницы в поисковой базе__

Опять же возьмите от 100 до 200 последних страниц и проверьте, есть ли они вообще в поисковой базе Яндекса. Для этого используйте фильтр `url:mysite.ru/my_page`. Какой бы запрос не ввел пользователь, какой бы ни была интересной информация на сайте, вашу страницу никто не найдет, если ее не будет в поисковой базе.

Например, мне обидно и странно, что [одни из наиболее посещаемых страниц Stack Overflow на русском](https://yandex.ru/search/?lr=2&text=url%3Ahttp%3A%2F%2Fru.stackoverflow.com%2Fquestions%2F127221%2F) никогда не попадают не только в выдачу, но и в поисковую базу.

__4. Инструменты веб-мастера__

В принципе какую-то информацию можно вытащить из [инструментов для веб-мастеров от Яндекса](http://webmaster.yandex.ru/).

Например, где-то в конце декабря Stack Overflow на русском полностью пропал из поиска, вообще! Как вы думает, в чем была причина? Кто-то в тестовых целях сделал перенаправление со своего домена на [ru.stackoverflow.com](http://ru.stackoverflow.com/). Оказывается, поиск Яндекса и тут работает с дефектами. Он определил, что непонятно взявшийся откуда-то домен является главным зеркалом, и закрыл мне весь доступ к сайту в инструментах для веб-мастеров (да-да, я более не управлял сайтом, потому что кто-то изменил настройки зоны! Мне тоже не верилось!). Потом перенаправление взяли и убрали! Все, вашего сайта больше нет (а для некоторых и бизнеса, возможно, всей жизни!), он перестал быть интересным – и его выпилили. И это, конечно же, ваша вина, а не поиска Яндекса. У Яндекса все работает, все хорошо: рынок, деньги, ну, вы поняли...

## Анализировать 200 страниц по нескольким показателям – затратно

Именно так я и подумал, и решил сделать жизнь чуть-чуть проще, как минимум себе. Я написал очень простое приложение, которое позволяет делать часть описанного выше. Исходный код приложения можно найти на GitHub по адресу: [github.com/chabanovsky/querychecker](https://github.com/chabanovsky/querychecker).

Приложение «заточено» под анализ Stack Overflow на русском, но изменить настройки, чтобы оно анализировало ваш сайт, займет минут 10, не более.

### Что же делает приложение?

__Run SQ__. Выполнить анализ поисковых запросов (Run Search Query Test). Данные для анализа берутся из файла _stats.json_, который находится в ресурсах проекта. Это файл содержит наиболее популярные запросы, по которым Stack Overflow на русском находят в поиске Google. Файл был загружен из Яндекс.Метрики (старый интерфейс). Изменений не вносилось. При необходимости просто замените на свой.

__Run NQ__. Выполнить анализ новых страниц на сайте (Run New Questions Test). Программа заходит на список новых страниц и собирает заголовки последних заданных вопросов. Далее переходит в поиск Яндекса и проверяет, будьте внимательны, наличие любой страницы сайта в поисковой выдаче по заданному запросу. То есть проверка идет не по точному совпадению адреса, а по совпадению корневого домена. Для модификации программы под ваш сайт, пожалуйста, обратите внимание на файл _utils.h_. В нем есть JavaScript код, с помощью которого собираются заголовки.

__Run NQWA__. Выполнить анализ новых вопросов, которые содержат ответы (Run New Questions With Answers Test). Идея, как и в _Run NQ_. Этот и следующий тест были добавлены после того, как Мистер Андерсон сказал, что _Run NQ_ – нечестный анализ, и надо анализировать только вопросы, которые «могут быть интересны пользователям». В нашем случае, это вопросы, получившие ответы.

__Run NAQ__. Выполнить анализ новых отвеченных вопросов (Run New Answered Questions Test). Отвеченные вопросы – это вопросы с ответами, которые были отмечены верными или имеют положительный рейтинг.

__Run NURLs__. Выполнить анализ наличия новых вопросов в поисковой базе (Run New URLs Test). Программа собирает данные о последних вопросах и проверяет, есть ли они в поисковой базе Яндекса.

### Результаты

Выполнение теста занимает 3–5 минут, в зависимости от скорости соединения. Результаты отображаются во всплывающем диалоговом окне. Я направлял результаты работы программы напрямую в службу поддержки Яндекса.

Буду рад, если кому-нибудь пригодится эта однодневная «лабораторная работа». Также буду рад доработать ее согласно отзывам. Да вы и сами можете ее доработать – исходный код доступен каждому!

Для Stack Overflow результаты плачевные – сайта нет в Яндексе, и, что хуже, пока что поддержка Яндекса дает явно понять, что он там и не появится. Рынок, деньги, ну, вы поняли… Работает – не трогай!


## В завершение немножко лирики

Побывав на нескольких конференциях и видя, что происходит в Рунете со Stack Overflow, я ужасаюсь. Яндекс вкладывает огромные (как минимум, для меня) средства в создание сообщества разработчиков вокруг компании: проводят хакатоны, рассказывают про технологии, выступают спонсорами конференций, да и, наконец, кормят всех пиццей и печенками на различных встречах в своих офисах.

__Вопрос: зачем все это, если Яндекс не справляется со своей основной функцией?__

Зачем рассказывать, какие вы молодцы (ни в коей мере в этом не сомневаюсь, очень люблю и пользуюсь многими сервисами), и в то же время предоставлять наиотвратительнейший опыт использования главного продукта? Зачем вкладывать деньги в создание сообщества, если в момент, когда Яндекс действительно нужен, он физически не работает. Разработчики на работе ищут решение, а вместо нормального ответа на адекватном сайте в поисковой выдаче Яндекса только ссылки на информационные помойки. Фамильярность!

Банально, вот как я попаду на ваш хакатон, если использование поиска Яндекса сделает невозможным решение задачи в заданные сроки? «Используй Google», – ответит мне любой коллега. Ребята из Яндекса, эти два слова сводят на нет всю вашу работу по расположению к себе разработчиков. А, как мы знаем, отчасти мнения именно разработчиков являются главной составляющей успеха. Сегодня рекомендуют искать в Google, карты использовать от 2GIS. Будет ли доля на рынке завтра с таким подходом-то? Уверен, у вас есть план, но все же…

Может все-таки стоит задуматься об исправлении дефектов? Вот есть же реальные данные, можно не посылать на... и не говорить, что сайт плохой (для всего мира Stack Overflow – лучший сайт для поиска ответов, а вот для Яндекса он плохой), а взять и разобраться, попробовать исправить дефекты, сделать продукт лучше! Не сторонний сайт «интересней для пользователей», а ваш, ваш поиск, ваш продукт!

Не можете, некогда и т. д.? Скажите, как вам помочь! Уверен, я не один, кто хочет сделать жизнь русскоязычного разработчика легче и лучше. Мы вместе, всем сообществом, поможем исправить ваши дефекты!


